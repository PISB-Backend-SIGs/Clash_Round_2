<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coding page rc round 2 </title>

    <link rel="stylesheet" href="{% static 'app1/css/codingPage.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>

</head>
<body class="mainBody">
  <nav class="navbar  mb-0 navbar-expand-lg navbarr">
    <div class="container-fluid">
      <a class="navbar-brand navvi" href="#" style="padding: 0px"><img src="{% static 'app1/images/clashwhite.png' %}"
          alt="Clash Logo" height="30px" /></a>
          <a class="navbar-brand navvi timer" id="timerDisplay2" style="margin-left: 20px;color:white">
                <script>
      x = setInterval(function() {    
          
        const countDown = new Date('{{end_time}}').getTime();
        const now = new Date().getTime();
        // console.log(new Date())
        remain = countDown - now;
        // console.log("b time",countDown,"f time", now ) 
        //console.log("remain",remain);

    //   document.getElementById("days").innerText = Math.floor(distance / (day)),
        const countdown = document.getElementById('countdown');

        let seconds = Math.floor((remain / 1000) % 60);
        let minutes = Math.floor((remain / (1000 * 60)) % 60);
        let hours = Math.floor((remain / (1000 * 60*60)) % 60);
        // document.getElementById("minutes").innerText = minutes;
        // sec = toString(seconds)
        // console.log(val_sec)
    hours = hours < 10 ? '0' + hours : hours;
    minutes = minutes < 10 ? '0' + minutes : minutes;
    seconds = seconds < 10 ? '0' + seconds : seconds;
    // console.log(hours+":"+ minutes + ":" +seconds)
    // document.getElementById('timerDisplay').innerHTML = hours+":"+ minutes + ":" +seconds;
              // var sub_btn = document.getElementById("submit_btn");
              // sub_btn.name = "nsubmit";
              // sub_btn.click();
              if (remain <=0){

                location.href = "{% url 'leaderboard' %}"
                clearInterval(x);
              }
            
          },0)

          
      </script>
          </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars" style="color: white"></i>
      </button>
      <div class="collapse navbar-collapse stroke" id="navbarSupportedContent">
        <ul class="navbar-nav mb-2 mb-lg-0" >
          <!-- <li class="nav-item">
            <a
              class="nav-link active navvi"
              aria-current="page"
              href="{% url 'questions' %}"
              style="margin-left: 10px; margin-right: 10px"
              >Question Hub</a
            >
          </li> -->
          <li class="nav-item">
            <a class="nav-link navvi" aria-current="page" href="{% url 'submission' %}"
              style="margin-left: 10px; margin-right: 10px ; color: lightblue;cursor: pointer;font-size:1.7rem;">Submissions</a>
          </li>

          <li class="nav-item navvi">
            <a class="nav-link navvi" style="margin-left: 10px; margin-right: 10px; color: lightblue; cursor: pointer;font-size:1.7rem;"
              href="{% url 'leaderboard' %}" data-bs-target="#LogoutModal">Leaderboard</a>
          </li>
          
            <!-- <li class="nav-item navvi">
              <a
                class="nav-link navvi"
                style="margin-left: 10px; margin-right: 10px; cursor: pointer;color:lightblue;cursor: pointer;font-size:1.7rem;"
                data-bs-toggle="modal"
                data-bs-target="#LogoutModal"
                >Logout</a
              >


           
           
          </li> -->
        </ul>
      </div>
      <a class="navbar-brand navvi pisblogo" href="#" style="padding: 0px; margin-left: 20px"><img
          src="{% static 'app1/images/pisblogo.png' %}" alt="Clash Logo" height="30px" /></a>
    </div>
  </nav>

  <div class="modal fade" id="LogoutModal" tabindex="-1" aria-labelledby="LogoutModalLabel"
  aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="LogoutModalLabel">Alert!</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        Are you sure you want to logout ?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" li>
          Cancel
        </button>
        <!-- <button type="button" class="btn btn-danger">
          <a href="{% url 'logout' %}">Logout</a>
        </button> -->
      </div>
    </div>
  </div>
</div>
  <!-- Hearder strip code starts -->
<section class="head-strip">
         <!-- Question numbers -->
   <div class="questions ">
    <div class="heading-div">
      <h4 class="text-center que-heading">
        Questions: 
      </h4>
</div>
     <div class="queno"><button type="button  "class=" btn  btn-dark qb  " id="qbtn1" onclick="location.href='/question/1'">1</button></div>
     <div class="queno"><button type="button " class=" btn btn-dark qb  " id="qbtn2" onclick="location.href='/question/2'">2</button></div>
     <div class="queno"><button type="button " class=" btn btn-dark   qb" id="qbtn3" onclick="location.href='/question/3'">3</button></div>
     <div class="queno"><button type="button " class=" btn btn-dark  qb " id="qbtn4" onclick="location.href='/question/4'">4</button></div>
     <div class="queno"><button type="button " class=" btn btn-dark   qb" id="qbtn5" onclick="location.href='/question/5'">5</button></div>
     <div class="queno"><button type="button " class=" btn btn-dark  qb " id="qbtn6" onclick="location.href='/question/6'">6</button></div>
    
   </div>
        <!-- Score  -->
   <div class="score-time">
    <div class="btn-group mx-auto" role="group" aria-label="Basic outlined example">
        <div type="button" class="btn btn-outline-dark "id="score">{{team.score}}</div>
      </div>
   </div>
</section>
  <!-- Header strip ends  -->

  <!-- The main Section  -->

<section class="coding ">
          <!-- the Question section starts here  -->
  <div class="questionpart">
    <div class="que-name">
      <h3  style="margin:0px" > {{question.q_title}} </h3>
  </div>
   <div class="quepart que-description" style="height: auto;">
    <h4 >Question Description</h4>
    {% if  question.image %}
    <div class="queimg text-center">
      <img src="{{question.image}}" alt="loding">

    </div>
    {% endif %}
     <p > {{question.q_descrp}} </p>
   </div>
   <div class="quepart que-constrains">
    <h4>Question Constraints</h4>
    {{question.q_const}}
   </div>
   <div class=" quepart que-examples">
    <h4>Examples</h4>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Mollitia consequuntur ipsum culpa omnis voluptatum harum animi totam minus asperiores! Exercitationem nam voluptates iusto deleniti voluptatibus non perspiciatis atque asperiores! Inventore optio sapiente itaque cupiditate eos necessitatibus aperiam ullam facere quae ut possimus harum laboriosam, ducimus odit, eum sit consectetur vel, consequuntur dicta quas.</p>
   </div>
 </div>


       <!-- The code Editor Section Starts here ... -->
   <form action="" method="POST" id="code_form">
    {% csrf_token %}

   
       <div class="codingpart">

    <div class="drop-buttons">
        <div class="lang">
            <select class="form-select langbtn btn-outline-dark  " id="langbtn" aria-label="Default select example" style="background-color: rgba(3, 111, 212, 0.696);">
                {% comment %} <option disabled selected value=""> Choose Language</option> {% endcomment %}
                <option value="python" selected>Python</option>
                <option value="cpp" {% if code_lang_cpp %}selected{% endif %}>C++</option>
                <option value="c" {% if code_lang_c %}selected{% endif %}>C</option>
              </select>
        </div>
        <!-- <div class="choosefile" >
        
         <input type="file"  class="form-control choosef btn-outline-dark"  id="customFile" accept=".c, .cpp, .py" />
        </div> -->

    </div>
    <div class="code-section">
      <div   class="codehere" id="editor1">
         
      </div>

      <!-- comsole section -->
       <div class="collapse mainconsole text-center" id="test-cases" >
         <div  style="display: flex;">
            <h3 class="text-center"> TEST-CASES</h3>
            <div class="spinner"></div>
          </div>    
        <div class="consoleBlocks ">

         <div class="block1 text-center">
           <h5 class="text-center"> Custom Input  </h5>
           <textarea id="testip">{{question.q_sip}}</textarea>
         </div>
         <div class="block2">
           <h5 class="text-center"> Output </h5>
           <div id="testop" disabled >{{question.q_sop}}</div>
         </div>

        </div>

        <!-- To show testcases on submit -->
        <div class="Status" id="Status">
          
        </div>
      </div>
      
    </div>

    

    <!-- The Submit Button Code Starts here  -->
    <div class="submit-strip mb-2">
      <div class="console">
        <button type="button" class="console-btn d-flex flex-wrap " data-toggle="collapse" id="console-btn"data-target="#test-cases" >
          Console
          <ion-icon name="chevron-up-outline"style=" font-size:18px" class="up mx-2 "></ion-icon>
          <ion-icon name="chevron-down-outline" style=" font-size:18px"class="down hidden"></ion-icon>
        </button>
    </div>
      <div class="submit-btn">
        <button type="button" class="run-btn   btn-outline-dark" id="run_code">Run</button>
      </div>
      <div class="submit-btn">
        <button type="button" class="run-btn  btn-outline-dark" id="submit_code">Submit</button>
      </div>
    </div>

   </div>
  </form>
</section>

{% comment %} 
<div class="overallStatus">
  Answer is Correct /Failed.
</div>
<div class="alltext d-flex flex-wrap ">
  <!-- <this is for wrong  -->
    <div class="test d-flex mx-3" style="align-items: center;"> Test Case 1   <ion-icon name="close-circle-outline" class="mx-3 my-1"  size="large"></ion-icon> </div>
 <!-- <this is for correct  -->
    <div class="test d-flex mx-3" style="align-items: center;"> Test Case 2  <ion-icon name="checkmark-circle-outline" class="mx-3 my-1" size="large"></ion-icon></div>
 <div class="test d-flex mx-3"style="align-items: center;"> Test Case 3  <ion-icon name="checkmark-circle-outline" class="mx-3 my-1" size="large"></ion-icon></div>
 <div class="test d-flex mx-3"style="align-items: center;"> Test Case 4  <ion-icon name="checkmark-circle-outline" class="mx-3 my-1" size="large"></ion-icon></div>
</div> 
{% endcomment %}
<!-- The Min Section ENds Here  -->
<footer class="text-center fixed-bottom footerr">
  <div class=" container-fluid">
      <div class="footer-text pt-3 pb-3">PISB <span>&copy</span></div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js"></script>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<script src="index.js"></script>     <!--The Javascript File .-->
<script src="{% static 'app1/js/codingPage.js' %}"></script>


<script >
  // console.log('{{isSolved}} | tojson')
  // console.log(" {{user_code}} | safe ")
  // console.log("SDAD")
  if ('{{isSolved}}'){
    console.log("enterd in if")
    // editor.session.setValue({{ user_code| safe}}) 
  }
  
  var que_no='{{question.q_id}}';
  var element=document.getElementById( "qbtn"+que_no);
  element.classList.add("glow");
  
  function getSelectedOption() {
  var selectElement = document.getElementById("langbtn"); // replace "mySelect" with the ID of your select element
  var selectedOption = selectElement.options[selectElement.selectedIndex].value;
  console.log('selected',selectedOption);
  return selectedOption;
} 
  function storeText() {
    // const textarea = document.querySelector('#editor1 textarea'); // select the textarea inside the #editor1 div
    // const text = textarea.value; // get the value of the textarea
    var selectedOption =getSelectedOption();
    const text=editor.getValue();
    console.log(text);
    let codes ={c:"#include<stdio.h>\n\n void main(){\n\n\n\t//write your code here \n}",cpp:"#include<iostream>\nusing namespace std;\nint main(){\n\n\n\t//write your code here \n\treturn 0;\n}",python:"#Write the Python code....."};
    // var cpp='{{code_lang_cpp}}'
    if(localStorage.getItem('codes') !==null)
      codes = JSON.parse(localStorage.getItem('codes'));
    if(selectedOption=='cpp'){
      codes.cpp=text;
    }
    else if(selectedOption=='c'){
      codes.c=text;
    }
    else{
      codes.python=text;
    }
    console.log(codes.cpp);
    localStorage.setItem('codes', JSON.stringify(codes)); 
  }

  const textarea = document.querySelector('#editor1 textarea');
  textarea.addEventListener('keyup', storeText); 

  function myFunction() {
    if(localStorage.getItem('codes') !==null){
      var selectedOption =getSelectedOption();
        codes = JSON.parse(localStorage.getItem('codes'));
        let text;
        if(selectedOption=='cpp'){
          text=codes.cpp;
        }
        else if(selectedOption=='c'){
          text=codes.c;
        }
        else{
          text=codes.python;
        }
        console.log('on reload',codes)
        // console.log(typeof(text),text);
        editor.setValue(`${text}`);
        // console.log('editor response',editor.getValue());

      }
      else{
        console.log('set value on referesh')
        let codes ={c:"#include<stdio.h>\n\n void main(){\n\n\n\t//write your code here \n}",cpp:"#include<iostream>\nusing namespace std;\nint main(){\n\n\n\t//write your code here \n\treturn 0;\n}",python:"#Write the Python code....."};
        localStorage.setItem('codes', JSON.stringify(codes)); 

      }
    }

    window.onload = myFunction;
  
  </script>
<script>
  

  var consoleBtnn = document.getElementById("console-btn");
var consoleBtnDown = consoleBtnn.querySelector(".down");
var consoleBtnUp = consoleBtnn.querySelector(".up");

consoleBtnn.addEventListener("click", function() {
  if (consoleBtnDown.classList.contains("hidden")) {
    consoleBtnDown.classList.remove("hidden");
    consoleBtnUp.classList.add("hidden");
  } else {
    consoleBtnDown.classList.add("hidden");
    consoleBtnUp.classList.remove("hidden");
  }

  if(editor1.classList.contains("hidden")){
    editor1.classList.remove("hidden");
    langSelect.classList.remove("hidden")
   }
   else{
       editor1.classList.add("hidden");
       langSelect.classList.add("hidden")
   }
});


//console buttons onclicke events 


</script>
{% include 'app1/ajax/ajax.html' %}
</body>
</html>